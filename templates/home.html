{% extends 'base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,400&family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link rel="stylesheet" href="{% static 'css/home.css' %}">

<section class="hero" style="{% if hero.background_image %}background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('{{ hero.background_image.url }}');{% endif %}">
    <div class="container animate__animated animate__fadeIn">
        <p class="text-uppercase letter-spacing-3 mb-3 fw-bold opacity-75">{{ hero.sub_title|default:"Est. 2025 ‚Ä¢ Fine Dining" }}</p>
        <h1>{{ hero.main_title_white|default:"Crafting" }} <span>{{ hero.main_title_span|default:"Moments" }}</span> <br> {{ hero.main_title_bottom|default:"Beyond Taste" }}</h1>
        <div class="mt-5">
            <a href="{% url 'menu' %}" class="btn-posh">{{ hero.menu_button_text|default:"View Our Menu" }}</a>
            <a href="#about" class="btn btn-outline-light rounded-pill px-5 py-3 ms-md-3 mt-3 mt-md-0">{{ hero.story_button_text|default:"Our Story" }}</a>
        </div>
    </div>
</section>

<section class="py-5 mt-5"><div class="container"><div class="row g-4 text-center">
    {% for feature in features %}<div class="col-md-3"><div class="feature-box shadow-sm h-100"><i class="{{ feature.icon_class }} fa-3x mb-4"></i><h5 class="fw-bold">{{ feature.title }}</h5><p class="small opacity-75 mb-0">{{ feature.description }}</p></div></div>
    {% empty %}<div class="col-12"><p class="text-muted">Welcome to our restaurant. Features coming soon!</p></div>{% endfor %}
</div></div></section>

<section id="about" class="py-5 mt-5"><div class="container"><div class="row align-items-center">
    <div class="col-lg-6 mb-5 mb-lg-0"><div class="position-relative">
        <img src="{% if about.image %}{{ about.image.url }}{% else %}https://via.placeholder.com/800{% endif %}" class="img-fluid rounded-5 shadow-lg" alt="Chef">
        <div class="position-absolute top-50 start-50 translate-middle"><div class="bg-white p-2 rounded-circle shadow-lg d-flex align-items-center justify-content-center" style="width: 100px; height: 100px;"><span class="text-primary fw-bold h3 mb-0">{{ about.experience_years }}</span></div></div>
    </div></div>
    <div class="col-lg-6 ps-lg-5"><span class="text-primary fw-bold text-uppercase">{{ about.legacy_tag }}</span><h2 class="playfair display-4 fw-bold mt-2 mb-4">{{ about.title|safe }}</h2><p class="text-muted lead">{{ about.description }}</p>
        <div class="row mt-5">
            <div class="col-4 border-end"><h3 class="fw-bold mb-0">{{ about.stat1_count }}</h3><small class="text-muted">{{ about.stat1_label }}</small></div>
            <div class="col-4 border-end ps-4"><h3 class="fw-bold mb-0">{{ about.stat2_count }}</h3><small class="text-muted">{{ about.stat2_label }}</small></div>
            <div class="col-4 ps-4"><h3 class="fw-bold mb-0">{{ about.stat3_count }}</h3><small class="text-muted">{{ about.stat3_label }}</small></div>
        </div>
    </div>
</div></div></section>

<section class="py-5"><div class="container text-center"><div class="section-head"><h2 class="playfair">Signature Collections</h2></div><div class="d-flex flex-wrap justify-content-center gap-3">
    {% for cat in categories %}<a href="{% url 'category_items' cat.id %}" class="cat-bubble text-decoration-none">{{ cat.name }} <span class="ms-1 opacity-50 small">({{ cat.item_count }})</span></a>{% endfor %}
</div></div></section>

{% if active_coupon %}
<section class="py-5">
    <div class="container">
        <div class="promo-coupon-card p-4 p-md-5 text-white position-relative overflow-hidden shadow-lg" 
             style="background: linear-gradient(135deg, #1a1a1a, #333); border-radius: 30px; border: 1px solid rgba(255,255,255,0.1);">
            
            <div class="position-absolute top-0 end-0 p-4 opacity-10">
                <i class="fas fa-gift fa-10x" style="transform: rotate(20deg);"></i>
            </div>

            <div class="row align-items-center position-relative">
                <div class="col-lg-8 text-center text-lg-start mb-4 mb-lg-0">
                    <h5 class="text-warning text-uppercase letter-spacing-2 mb-2 fw-bold small">Special Offer Available</h5>
                    <h2 class="playfair display-5 fw-bold mb-3">‡¶è‡¶ñ‡¶®‡¶á ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶ú‡¶ø‡¶§‡ßá ‡¶®‡¶ø‡¶® ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶õ‡¶æ‡ßú!</h2>
                    <p class="opacity-75 lead mb-0">
                        ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞‡ßá <strong>{{ active_coupon.discount }}%</strong> ‡¶°‡¶ø‡¶∏‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶™‡ßá‡¶§‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶ï‡ßÅ‡¶™‡¶®‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
                    </p>
                </div>
                <div class="col-lg-4 text-center">
                    <div class="coupon-display-box bg-white text-dark p-3 rounded-4 shadow-sm" style="border: 2px dashed #ff4757;">
                        <p class="small text-muted mb-1 fw-bold text-uppercase">Coupon Code</p>
                        <h3 class="fw-bold text-danger mb-2" style="letter-spacing: 2px;">{{ active_coupon.code }}</h3>
                        <button onclick="copyCoupon('{{ active_coupon.code }}')" class="btn btn-dark w-100 rounded-pill py-2 fw-bold">
                            <i class="far fa-copy me-2"></i> ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}

<section class="py-5"><div class="container">
    <div class="section-head d-flex justify-content-between align-items-end mb-4"><div><h2 class="playfair fw-bold">Top Masterpieces</h2><p class="text-muted">Our most beloved signature dishes</p></div><a href="{% url 'menu' %}" class="text-dark fw-bold mb-3">View All <i class="fas fa-arrow-right ms-2"></i></a></div>
    <div class="row g-4">
        {% for item in top_selling %}<div class="col-lg-3 col-md-6"><div class="premium-card text-center shadow-sm p-3 rounded-4 bg-white h-100 transition-hover">
            <div class="img-wrapper mb-3" style="height: 200px; overflow: hidden; border-radius: 15px;"><img src="{% if item.image %}{{ item.image.url }}{% else %}https://via.placeholder.com/300x200{% endif %}" class="img-fluid w-100 h-100 object-fit-cover"></div>
            <div class="p-2"><h6 class="fw-bold mb-2">{{ item.name }}</h6><p class="text-primary fw-bold fs-5 mb-3">‡ß≥ {{ item.price }}</p><a href="{% url 'add_to_cart' item.id %}" class="btn btn-danger w-100 rounded-pill py-2">Add To Cart</a></div>
        </div></div>{% endfor %}
    </div>
</div></section>

<section class="py-5 bg-white"><div class="container"><div class="section-head"><h2 class="playfair">Today's Specials</h2></div><div class="row g-4">
    {% for food in today_specials %}<div class="col-lg-3 col-md-6"><div class="premium-card text-center border">
        <div class="img-wrapper">{% if food.image %}<img src="{{ food.image.url }}">{% endif %}</div>
        <div class="p-4"><h6 class="fw-bold mb-2">{{ food.name }}</h6><p class="text-primary fw-bold fs-5 mb-3">‡ß≥ {{ food.price }}</p><a href="{% url 'add_to_cart' food.id %}" class="btn btn-outline-dark w-100 rounded-pill py-2">Order Now</a></div>
    </div></div>{% endfor %}
</div></div></section>

<section class="py-5"><div class="container"><div class="section-head"><h2 class="playfair">Exclusive Offers</h2></div><div class="row g-4">
    {% for offer in offers %}<div class="col-lg-3 col-md-6"><div class="premium-card text-center"><span class="badge-offer">{{ offer.discount_percentage }}% OFF</span><div class="img-wrapper">{% if offer.food.image %}<img src="{{ offer.food.image.url }}">{% endif %}</div>
        <div class="p-4"><h6 class="fw-bold mb-2">{{ offer.title }}</h6><p class="text-danger fw-bold fs-5 mb-3">‡ß≥ {{ offer.discounted_price }}</p><a href="{% url 'add_to_cart' offer.food.id %}" class="btn btn-dark w-100 rounded-pill py-2">Claim Offer</a></div>
    </div></div>{% endfor %}
</div></div></section>

<style>
.reservation-full-screen { position: relative; width: 100%; overflow: hidden; }
.luxury-img-wrap { position: relative; height: 80vh; min-height: 500px; width: 100%; overflow: hidden; }
.luxury-full-img { width: 100%; height: 100%; object-fit: cover; display: block; }
.img-dark-layer { position: absolute; inset: 0; background: rgba(0,0,0,0.35); }
.booking-overlay-card { position: absolute; right: 5%; top: 50%; transform: translateY(-50%); z-index: 5; }
.reservation-glass-box { backdrop-filter: blur(18px); background: rgba(255,255,255,0.88); padding: 50px; border-radius: 20px; box-shadow: 0 25px 60px rgba(0,0,0,0.2); max-width: 650px; width: 100%; }
.luxury-btn { display: inline-flex; align-items: center; gap: 10px; padding: 14px 28px; border-radius: 50px; background: black; color: white; text-decoration: none; transition: 0.3s; }
@media (max-width: 768px) { .luxury-img-wrap { height: 50vh; } .booking-overlay-card { position: relative; top: auto; transform: none; margin: -70px auto 0; padding: 0 15px; } .reservation-glass-box { padding: 28px; } }
</style>

<section class="reservation-full-screen my-5"><div class="container-fluid p-0"><div class="row g-0 align-items-center position-relative">
    <div class="col-lg-8 p-0"><div class="luxury-img-wrap"><img src="https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=1500" class="luxury-full-img"><div class="img-dark-layer"></div><div class="image-text-content d-none d-lg-block position-absolute bottom-0 left-0 p-5 text-white"><h3 class="playfair italic">The Art of Fine Dining</h3></div></div></div>
    <div class="col-lg-5 col-md-8 col-11 booking-overlay-card"><div class="reservation-glass-box">
        <span class="sub-title">Reservations</span><h2 class="playfair mt-3">Reserve Your <br><span>Royal Table</span></h2>
        <p class="text-muted mt-4 mb-5">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶ï‡ßç‡¶≤‡ßÅ‡¶∏‡¶ø‡¶≠ ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡ßá‡¶ü ‡¶°‡¶æ‡¶á‡¶®‡¶ø‡¶Ç ‡¶è‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶®‡¶ü‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
        <div class="d-flex gap-4 mb-5"><div class="f-item"><i class="fas fa-wine-glass me-2"></i>Private Events</div><div class="f-item"><i class="fas fa-clock me-2"></i>Instant Booking</div></div>
        <a href="reservations/reserve/" class="luxury-btn"><span>Book A Table</span><i class="fas fa-long-arrow-right"></i></a>
    </div></div>
</div></div></section>

<section class="combo-section py-5 bg-light"><div class="container">
    <div class="text-center mb-5"><h2 class="display-5 fw-bold">üî• ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßç‡¶™‡ßá‡¶∂‡¶æ‡¶≤ ‡¶ï‡¶Æ‡ßç‡¶¨‡ßã ‡¶Ö‡¶´‡¶æ‡¶∞</h2><p class="text-muted">‡¶Ö‡¶≤‡ßç‡¶™ ‡¶¶‡¶æ‡¶Æ‡ßá ‡¶™‡ßá‡¶ü‡¶≠‡¶∞‡¶æ ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞!</p></div>
    <div class="row g-4">
        {% for combo in combos %}<div class="col-md-6 col-lg-4"><div class="card h-100 border-0 shadow-sm rounded-4 overflow-hidden">
            {% if combo.image %}<img src="{{ combo.image.url }}" class="card-img-top" style="height: 220px; object-fit: cover;">{% endif %}
            <div class="card-body p-4 text-center"><h4 class="fw-bold">{{ combo.name }}</h4><div class="my-3"><span class="text-decoration-line-through text-muted me-2">‡ß≥{{ combo.original_price }}</span><span class="h3 fw-bold text-success">‡ß≥{{ combo.discount_price }}</span></div><a href="{% url 'add_combo_to_cart' combo.id %}" class="btn btn-danger w-100 rounded-pill">‡¶ï‡¶æ‡¶∞‡ßç‡¶ü‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</a></div>
        </div></div>{% empty %}<p class="text-center">‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§! ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶Æ‡ßç‡¶¨‡ßã ‡¶°‡¶ø‡¶≤ ‡¶®‡ßá‡¶á‡•§</p>{% endfor %}
    </div>
</div></section>

<section class="py-5"><div class="container"><div class="flash-deal-card p-5 text-white" style="background: linear-gradient(135deg, #111, #222); border-radius: 40px; border-left: 8px solid #ff4757;">
    <div class="row align-items-center"><div class="col-lg-7">
        <div class="d-flex align-items-center mb-3"><span class="live-badge bg-danger px-2 rounded">LIVE</span><span class="text-warning fw-bold ms-3">Flash Deal</span></div>
        <h2 class="display-4 fw-bold mb-3 playfair">The "Gemini" Mega Combo</h2>
        <div class="d-flex gap-3 mb-4">
            <div class="timer-box"><span id="hours-box" class="timer-val">00</span><br><small>Hours</small></div>
            <div class="timer-box"><span id="mins-box" class="timer-val">00</span><br><small>Mins</small></div>
            <div class="timer-box"><span id="secs-box" class="timer-val">00</span><br><small>Secs</small></div>
        </div>
        {% if flash_deal %}<a href="{% url 'add_deal_to_cart' flash_deal.id %}" class="btn btn-danger btn-lg rounded-pill px-5">Claim Now</a>{% endif %}
    </div><div class="col-lg-5 text-center"><div class="image-stack position-relative mt-4"><img src="https://www.kailashparbat.com.sg/images/menu/super-saver-combo-2.jpg" class="img-fluid rounded-4" style="max-height:250px"><div class="discount-tag position-absolute top-0 end-0 bg-danger p-2">40% OFF</div></div></div></div>
</div></div></section>

<section class="py-5"><div class="container"><div class="section-head"><h2 class="playfair">Guest Experiences</h2></div><div class="swiper testimonialSwiper pb-5"><div class="swiper-wrapper">
    {% for review in testimonials %}<div class="swiper-slide"><div class="p-5 bg-white rounded-5 shadow-sm text-center border">
        <img src="{% if review.image %}{{ review.image.url }}{% else %}https://ui-avatars.com/api/?name={{ review.name }}{% endif %}" class="rounded-circle mb-3" style="width:80px;height:80px">
        <p class="fst-italic text-muted">"{{ review.review_text|truncatechars:100 }}"</p><h6 class="fw-bold">{{ review.name }}</h6>
    </div></div>{% endfor %}
</div><div class="swiper-pagination"></div></div></div></section>

<section class="home-blog py-5" style="background: #fcfcfc;"><div class="container"><div class="row mb-5 align-items-end"><div class="col-lg-7"><h2 class="playfair display-4">Latest Stories</h2></div><div class="col-lg-5 text-end"><a href="{% url 'blog_list' %}">Explore All <i class="fas fa-arrow-right"></i></a></div></div>
    <div class="row g-4">{% for blog in blogs %}<div class="col-lg-3 col-md-6"><div class="blog-entry-card"><div class="entry-img-wrap">{% if blog.thumbnail %}<img src="{{ blog.thumbnail.url }}" class="w-100">{% endif %}</div><div class="p-4"><h4 class="playfair"><a href="{% url 'blog_detail' blog.slug %}">{{ blog.title }}</a></h4><p class="small text-muted">{{ blog.content|truncatewords:10 }}</p></div></div></div>{% endfor %}</div>
</div></section>

{% include 'includes/footer.html' %}

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
    let hours = 17, minutes = 11, seconds = 4;
    setInterval(() => {
        if (seconds > 0) seconds--; else { if (minutes > 0) { minutes--; seconds = 59; } else if (hours > 0) { hours--; minutes = 59; seconds = 59; } }
        document.getElementById("hours-box").innerText = hours.toString().padStart(2, '0');
        document.getElementById("mins-box").innerText = minutes.toString().padStart(2, '0');
        document.getElementById("secs-box").innerText = seconds.toString().padStart(2, '0');
    }, 1000);
    document.addEventListener('DOMContentLoaded', () => { new Swiper(".testimonialSwiper", { slidesPerView: 1, spaceBetween: 30, loop: true, autoplay: { delay: 4000 }, pagination: { el: ".swiper-pagination", clickable: true }, breakpoints: { 768: { slidesPerView: 2 }, 1024: { slidesPerView: 3 } } }); });
</script>
{% endblock %}